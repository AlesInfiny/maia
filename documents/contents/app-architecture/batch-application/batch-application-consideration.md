---
title: バッチアプリケーション編
description: バッチアプリケーションでの検討事項について解説します。
---

# バッチアプリケーションの検討事項 {#batch-implementation}

バッチアプリケーションを実際に運用していく中で発生しうる課題について、どのように対応していくかを解説します。

## バッチアプリケーションの起動がボトルネックとなる {#start-bottleneck}

大量で反復的なデータを処理するバッチ処理を行う場合、定められた実行時間で処理を完了させる必要があります。
特に、本アーキテクチャで利用している Spring Boot アプリケーションにおいては、 Bean の初期化を起動時に実行する特性上、アプリケーションの起動がバッチ処理のボトルネックとなる場合があります。
このような場合、以下の方法による解決を考慮してみてください。

### クラウドのリソースを利用したバッチ処理のスケジューリング {#cloud-resource}

クラウドコンピューティングサービスを利用してバッチ処理を自動的に実行するようスケジューリングすることで、以下のような特徴があげられます。

**効率性**
クラウドサービスのスケジューリング機能を適用することで、人による操作を最小限に抑え、反復的なタスクをバッチ処理として実行できます。

**高速化**
クラウドサービスは大量のコンピューティングリソースを提供しており、これによりバッチ処理の高速化が期待できます。

**リソースの最適化**
クラウドサービスのオートスケール機能は必要に応じてリソースをスケールアップ、スケールダウンすることで、メモリ使用量を最適化します。これにより、データ使用量が増えた場合でも時間内の処理を実現でき、データ使用量が少ない場合には無駄なリソースの消費を抑えることができます。

上記の特徴を活かしクラウドサービスのリソースを利用したバッチ処理を構築することで、システムの負荷を分散し効率的な処理を実行でき、定められた時間内での処理を実現できます。

### @Scheduled アノテーションを利用した実行 {#scheduled-annotation}

クラウドのサービスを利用しない場合、バッチ処理を高速で実行するために Spring Boot アプリケーションの機能で対処する方法があります。
バッチ処理を実行するたびに Spring Boot アプリケーションを起動する必要がないように、バッチアプリケーションを常時起動しておき定期的にタスクを実行するためのスケジューリング機能が提供されています。
[@Scheduled アノテーション](https://spring.pleiades.io/guides/gs/scheduling-tasks) は、タスクの定期的な実行を実現できる機能です。
このアノテーションを利用すれば、一度アプリケーションを起動した後は定期的にバッチ処理が自動実行されるようになり、 Bean の初期化にかかる起動時間を短縮できます。
これにより、バッチアプリケーションの高速化やリソースの削減が期待できます。
そのため、常駐バッチのようにあらかじめ設定された間隔で実行する際には本機能の利用を推奨します。

### GraalVM を利用した実行 {#graal-vm}

[GraalVM](https://www.oracle.com/jp/java/graalvm/what-is-graalvm/) は、 Oracle 社が開発した　Java アプリケーションをネイティブなバイナリー実行ファイル（ネイティブイメージ）にコンパイルする機能を持った JDK です。
GraalVM を利用することで、 JVM を介さず直接実行できるネイティブイメージを作成することが可能となり、実行速度の高速化やメモリ使用量の削減を期待できます。

GraalVM を利用したサンプルアプリケーションの実行検証については、以下をご確認ください。

- [GraalVM の実行検証記事](https://qiita.com/RyoNakagawa2/items/c0b29955cb7f1bfd7c75)
