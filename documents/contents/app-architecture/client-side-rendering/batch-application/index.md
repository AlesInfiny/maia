---
title: CSR 編 - バッチアプリケーション
description: バッチアプリケーションについて概要や、主に使用する OSS ライブラリを解説します。
---

# バッチアプリケーション {#top}

バッチアプリケーションは、一連のタスクやプログラムを自動的に実行するアプリケーションです。
人による操作を最小限に抑え、複数の処理をまとめて自動的に実行することで、効率的な処理が可能となります。
主に大量なデータ処理や繰り返し処理などに利用されます。

## バッチ処理の種類 {#batch-variable}

### オンバッチ {#online-batch}

オンバッチは、ユーザーの任意のタイミングで実行されるバッチ処理です。
ユーザーが必要に応じて実行できます。
例えば、特定のデータを一括で処理したい場合や特定の操作するためにバッチ処理を実行する場合などに利用されます。

オンバッチはユーザーの操作に応じた柔軟な実行が特徴であることから、後述する定期バッチと比較して複雑なバッチ処理を実行できる特徴があります。
しかしながら、処理が複雑になった場合、バッチ実行によるシステムの負荷が大きくなります。
そのため、処理を高速化したり使用するリソースを削減したりといった、システムの負荷を軽減するための対処を考える必要があります。

### 定期バッチ {#scheduled-batch}

定期バッチは、あらかじめ設定された一定の間隔で自動的に実行されるバッチ処理です。
定期的にデータを更新する必要がある場合に利用されます。
例えば、毎日深夜にデータベースのバックアップを取る処理や、毎週月曜日に売上データを集計する処理などです。

定期バッチは、あらかじめ設定されたリソースを利用して実行されるため、リソースを効率的に管理できます。
その反面、他の重要な処理やリクエストとリソースが競合することで、複雑なバッチ処理が。
また、定期バッチ処理は自動的に実行されるため、エラーや問題が発生した場合にその発見が遅れる可能性もあります。

## バッチアプリケーションの実装方法 {#batch-implementation}

前述したとおり、大量で反復的なデータを処理するバッチ処理を行う場合、システムの負荷が高く非効率となる場合があります。
このような場合、以下の方法で解決できます。

### クラウドのリソースを利用したバッチ処理のスケジューリング {#cloud-resource}

クラウドコンピューティングサービスを利用してバッチ処理を自動的に実行するようスケジューリングすることで、以下のような特徴があげられます。

**効率性**
クラウドサービスのスケジューリング機能を適用することで、人による操作を最小限に抑え、反復的なタスクを定期バッチとして実行できます。

**高速化**
クラウドサービスは大量のコンピューティングリソースを提供しており、これによりバッチ処理の高速化が期待できます。

**リソースの最適化**
クラウドサービスのオートスケール機能は必要に応じてリソースをスケールアップ、スケールダウンすることで、メモリ使用量を最適化します。これにより、データ使用量が増えた場合でも時間内の処理を実現でき、データ使用量が少ない場合には無駄なリソースの消費を抑えることができます。

バッチ処理を行う際のシステムの負荷が問題となっている場合、バックエンドアプリケーションをクラウドのリソース上に配置して、システムの負荷削減を図ることを考慮してください。

### @Scheduled アノテーションを利用した実行 {#scheduled-annotation}

クラウドのサービスを利用しない場合、バッチ処理を高速で実行するために Spring Boot アプリケーションの機能のみで対処する方法があります。
Spring Boot アプリケーションは Bean の初期化を起動時に実行する特性上、アプリケーションの起動がバッチ処理のボトルネックとなる場合があります。
そこで、バッチ処理を実行するたびに Spring Boot アプリケーションを起動する必要がないように、バッチアプリケーションを定期実行するための機能が提供されています。
@Scheduled アノテーションは、メソッドの定期的な実行を実現できる機能です。
アノテーションを利用すれば、一度アプリケーションを起動した後は定期的にバッチ処理が自動実行されるようになり、 Bean の初期化にかかる起動時間を短縮できます。
これにより、バッチアプリケーションの高速化やリソースの削減が期待できます。
そのため、定期バッチのようにあらかじめ設定された間隔で実行する際には本機能の利用を推奨します。

### GraalVM を利用した実行 {#graal-vm}

GraalVM は、 Oracle 社が開発した高パフォーマンスの JDK です。
Spring Boot をはじめとする JVM ベースのアプリケーションを事前にネイティブイメージへコンパイルします。
これにより、ソースコードの変更を最小限に抑え、起動時間を短縮しリソース使用量を削減させることができます。

GraalVM を利用したサンプルアプリケーションの実行検証については、以下をご確認ください。

- [GraalVM の実行検証記事](https://graalvm.github.io/native-build-tools/0.9.28/)

## バッチアプリケーションを構築するための OSS ライブラリ {#oss-library}

### Spring Batch {#spring-batch}
