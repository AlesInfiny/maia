---
title: 全体処理方式
description: クライアントサイドレンダリング方式のアプリケーション全体で考慮すべきアーキテクチャについて、その実装方針を説明します。
---

# 全体処理方式 {#top}

クライアントサイドレンダリング方式のアプリケーション全体で考慮すべきアーキテクチャについて、その実装方針を説明します。

## 例外処理方針 {#exception-policy}

バックエンドアプリケーションで発生するシステム例外や業務例外は、例外フィルターによって捕捉します。
例外フィルターでは、ログ出力方針に従ってアプリケーションログを出力します。

システム例外を例外フィルターで捕捉した場合は、 HTTP 500 のエラーレスポンスをフロントエンドアプリケーションに返却します。
フロントエンドアプリケーションは、システムエラー画面に遷移し、 Sorry メッセージを出力します。
フロントエンドアプリケーション内で例外が発生した場合も、同様にシステムエラー画面に遷移します。

業務例外を例外フィルターで補足した場合は、 HTTP 400 のエラーレスポンスをフロントエンドアプリケーションに返却します。
フロントエンドアプリケーションは、その画面内のメッセージ領域にエラーメッセージを表示します。

![例外処理方針](../../images/app-architecture/client-side-rendering/exception-handling-policy-light.png#only-light){ loading=lazy }
![例外処理方針](../../images/app-architecture/client-side-rendering/exception-handling-policy-dark.png#only-dark){ loading=lazy }

## ログ出力方針 {#logging-policy}

Java アプリケーションのログ出力方針については、以下を参照してください。

- [Java アプリケーションの処理方式 - ログ出力方針](../../app-architecture/overview/java-application-processing-system.md#logging-policy)

以降、本節では Vue.js のフロントエンドアプリケーションのログ出力方針を示します。

### ログの種類 {#log-pattern}

Maia OSS 版で定義するフロントエンドアプリケーションのログの種類は以下の通りです。

- アプリケーションログ

    アプリケーションのロジック内から出力する汎用的なログをアプリケーションログと呼びます。
    フロントエンドアプリケーションから出力するログは、主に開発目的で出力します。

### ログレベル {#log-level}

出力するログにはログレベルを定義します。
フロントエンドアプリケーションのログレベルの定義は以下の通りです。

- Error

    システムエラー発生時に使用します。

- Warning

    業務エラー発生時に使用します。

- Information ( ログレベル指定なし )

    開発者のデバッグ目的に使用してもかまいませんが、原則使用しません。

### ログレベルと環境ごとの出力設定 {#configuration-of-log-levels-and-output-per-environment}

フロントエンドアプリケーションは、システムの実行環境によらず、すべてのレベルのログを出力します。

### ログに含める標準データ {#standard-log-data}

以下の情報をフロントエンドアプリケーションのログに含めます。

- ログ出力日時
- ログレベル
- メッセージ

### ロギングライブラリ {#logging-libraries}

フロントエンドアプリケーションでは `#!ts console` オブジェクトを利用して、ログをブラウザーのデバッグコンソールに出力します。

## メッセージ管理方針 {#message-management-policy}

Java アプリケーションのメッセージ管理方針については、以下を参照してください。

- [Java アプリケーションの処理方式 - メッセージ管理方針](../../app-architecture/overview/java-application-processing-system.md#message-management-policy)

フロントエンドアプリケーションでは、特別なメッセージ管理しません。
画面内に出力するメッセージやラベルは、各画面やソースコード内に個別に実装したものを使用します。

<!-- ### トランザクション管理 -->

## 入力値検査方針 {#validation-policy}

入力値検査は単項目チェックと項目間チェック、複合チェックに分類し、それぞれ以下の方針で処理します。

### 単項目チェック {#single-item-check}

入力必須チェック、桁チェック、型チェックなど、単一のフィールドのみで完結する入力値検証です。
フロントエンドアプリケーションとバックエンドアプリケーション、それぞれで同一の入力値検証します。

フロントエンドアプリケーションでは、入力誤りの情報を素早くユーザーにフィードバックすることを目的に実施します。
バックエンドアプリケーションで実施する入力値検証を補助します。
入力値検証は VeeValidate と yup を利用して実施します。

バックエンドアプリケーションでは、誤った入力情報がシステムに投入されることを防止する目的に実施します。
入力値検証は Bean Validation を利用して実施します。

### 項目間チェック {#cross-field-check}

パスワードと確認用パスワードの一致チェック、タスク終了日が開始日より後であることのチェックなど、複数のフィールドを比較する入力値検証です。
フロントエンドアプリケーションとバックエンドアプリケーションで、同一の項目を持つ場合は、それぞれで同一の入力値検証します。

フロントエンドアプリケーションでは、入力誤りの情報を素早くユーザーにフィードバックすることを目的に実施します。
バックエンドアプリケーションで実施する入力値検証を補助します。
入力値検証は VeeValidate と yup を利用して実施します。

バックエンドアプリケーションでは、誤った入力情報がシステムに投入されることを防止する目的に実施します。
入力値検証はプレゼンテーション層の業務ロジック内で実装します。
繰り返し使用するものは Bean Validation を独自拡張して汎用化します。

### 複合チェック {#complex-check}

ID の重複チェック、注文数が在庫数以内であるかのチェックなど、システムの状態によって入力値が妥当かどうかが変わる入力値検証です。
多くの場合、データストア内のデータと突き合わせて乳領地の妥当性を確認します。

複合チェックはバックエンドアプリケーションでのみ実施します。
アプリケーションコア層の業務ロジック内でチェック処理を実装します。
入力エラーがある場合は、 HTTP 400 のステータスコードを使用して、エラーの存在を通知します。
また入力エラーのあった個所とエラーメッセージを、エラーレスポンスの本文を使用して通知します。

<!-- ### セキュリティ対策 -->
