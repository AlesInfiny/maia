<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout}">
  <head>
    <title>お知らせメッセージ管理</title>
  </head>
  <body>
    <th:block layout:fragment="content">
      <!--/* ページタイトル */-->
      <h1 class="display-6 mb-4" th:text="#{announcement.index.pageTitle}"></h1>

      <!--/* お知らせメッセージ管理ヘッダー部 */-->
      <div class="d-flex align-items-center gap-2 mb-3">
        <!--/* 件数表示 */-->
        <span
          th:text="#{announcement.index.countAndRange(${viewModel.totalCount}, ${viewModel.startCount}, ${viewModel.endCount})}"></span>
        <!--/* 前ページボタン */-->
        <a
          th:href="@{/announcements(pageNumber=${viewModel.pageNumber - 1}, pageSize=${viewModel.pageSize})}"
          class="btn btn-sm btn-outline-secondary"
          th:classappend="${!viewModel.hasPrevious} ? ' disabled' : ''"
          th:attr="aria-disabled=${!viewModel.hasPrevious} ? 'true' : null"
          th:onclick="${!viewModel.hasPrevious} ? 'return false;' : ''">
          &lt;
        </a>
        <!--/* 次ページボタン */-->
        <a
          th:href="@{/announcements(pageNumber=${viewModel.pageNumber + 1}, pageSize=${viewModel.pageSize})}"
          class="btn btn-sm btn-outline-secondary"
          th:classappend="${!viewModel.hasNext} ? ' disabled' : ''"
          th:attr="aria-disabled=${!viewModel.hasNext} ? 'true' : null"
          th:onclick="${!viewModel.hasNext} ? 'return false;' : ''">
          &gt;
        </a>
        <!--/* 新規作成ボタン */-->
        <a th:href="@{/announcements/create}" class="text-primary" th:text="#{announcement.index.createButton}"></a>
      </div>

      <!--/* お知らせメッセージリスト部 */-->
      <!--/* お知らせメッセージが 0 件の場合 */-->
      <div th:if="${!viewModel.existAnnouncement()}" th:text="#{announcement.index.noAnnouncementMessages}"></div>

      <!--/* お知らせメッセージが 1 件以上の場合 */-->
      <div th:if="${viewModel.existAnnouncement()}">
        <table class="table table-hover mb-0">
          <thead class="table-light">
            <tr>
              <th scope="col" th:text="#{announcement.index.title}"></th>
              <th scope="col" th:text="#{announcement.index.publicationPeriod}"></th>
              <th scope="col" th:text="#{announcement.index.category}"></th>
              <th scope="col" th:text="#{announcement.index.displayPriority}"></th>
              <th scope="col" th:text="#{announcement.index.operation}"></th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="item : ${viewModel.announcements}">
              <td>
                <a
                  th:href="@{/announcements/{id}/edit(id=${item.announcement.id})}"
                  th:text="${item.content.title}"></a>
              </td>
              <td>
                <span th:text="${#temporals.format(item.announcement.postDate, 'yyyy-MM-dd')}"></span>
                <span
                  th:if="${item.announcement.expireDate != null}"
                  th:text="| - ${#temporals.format(item.announcement.expireDate, 'yyyy-MM-dd')}|"></span>
              </td>
              <td th:text="${item.announcement.category}"></td>
              <td>
                <span th:text="${displayPriority[item.announcement.displayPriority - 1].label}"></span>
              </td>
              <td>
                <a
                  th:href="@{/announcements/{id}/edit(id=${item.announcement.id})}"
                  class="btn btn-sm btn-outline-primary me-2"
                  th:text="#{announcement.index.edit}"></a>
                <a
                  th:href="@{/announcements/{id}/delete/confirm(id=${item.announcement.id})}"
                  class="btn btn-sm btn-outline-danger"
                  th:text="#{announcement.index.delete}"></a>
              </td>
            </tr>
          </tbody>
        </table>

        <!--/* ページネーション部 */-->
        <nav aria-label="ページネーション" class="mt-3">
          <ul class="pagination justify-content-center mb-0">
            <!--/* 1ページ目 */-->
            <li class="page-item" th:classappend="${viewModel.pageNumber == 1} ? ' active disabled'">
              <a
                class="page-link"
                th:href="${viewModel.pageNumber == 1} ? null : @{/announcements(pageNumber=1, pageSize=${viewModel.pageSize})}">
                1
              </a>
            </li>

            <!--/* 省略記号(前方) */-->
            <li class="page-item disabled" th:if="${viewModel.pageNumber - 3 > 1}">
              <span class="page-link">…</span>
            </li>

            <!--/* 中間ページ */-->
            <li
              class="page-item"
              th:each="i : ${#numbers.sequence(viewModel.pageNumber - 2, viewModel.pageNumber + 2)}"
              th:if="${i > 1 && i < viewModel.lastPageNumber}"
              th:classappend="${viewModel.pageNumber == i} ? ' active disabled'">
              <a
                class="page-link"
                th:href="${viewModel.pageNumber == i} ? null : @{/announcements(pageNumber=${i}, pageSize=${viewModel.pageSize})}"
                th:text="${i}"></a>
            </li>

            <!--/* 省略記号(後方) */-->
            <li class="page-item disabled" th:if="${viewModel.pageNumber + 3 < viewModel.lastPageNumber}">
              <span class="page-link">…</span>
            </li>

            <!--/* 最後のページ（2ページ以上ある場合のみ） */-->
            <li
              class="page-item"
              th:if="${viewModel.lastPageNumber > 1}"
              th:classappend="${viewModel.pageNumber == viewModel.lastPageNumber} ? ' active disabled'">
              <a
                class="page-link"
                th:href="${viewModel.pageNumber == viewModel.lastPageNumber} ? null : @{/announcements(pageNumber=${viewModel.lastPageNumber}, pageSize=${viewModel.pageSize})}"
                th:text="${viewModel.lastPageNumber}"></a>
            </li>
          </ul>
        </nav>
      </div>
    </th:block>
  </body>
</html>
